---
/**
 * LogViewer - Log viewer tab component (LOGS-02)
 * Displays log file selector dropdown, live tail toggle, search input,
 * and terminal-style log output area. All values populated by logs.ts.
 */
---

<div class="log-controls">
  <select id="log-file-select">
    <option value="" disabled selected>Select log file...</option>
  </select>
  <button id="log-tail-toggle" type="button">
    <span id="log-tail-dot" class="tail-dot"></span>
    <span id="log-tail-label">Live Tail</span>
  </button>
  <input id="log-search" type="text" placeholder="Search logs..." />
</div>

<div id="log-output" class="log-output"></div>
<div id="log-empty" class="log-empty"><p>Select a log file to view entries.</p></div>
<div id="log-loading" class="log-loading" style="display:none"><p>Loading...</p></div>

<style>
  .log-controls {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-sm);
    position: sticky;
    top: 0;
    z-index: 10;
    background: var(--color-surface);
    padding: var(--spacing-sm) 0;
    border-bottom: 1px solid var(--color-border);
    margin-bottom: var(--spacing-sm);
  }

  select#log-file-select {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    color: var(--color-text);
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    padding: 6px 10px;
    border-radius: 4px;
    min-width: 300px;
    cursor: pointer;
  }

  select#log-file-select:focus {
    outline: none;
    border-color: var(--color-accent);
  }

  #log-tail-toggle {
    display: flex;
    align-items: center;
    gap: 6px;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    color: var(--color-text);
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    white-space: nowrap;
  }

  #log-tail-toggle:hover {
    border-color: var(--color-accent);
  }

  .tail-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--color-text-secondary);
  }

  #log-search {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    color: var(--color-text);
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    padding: 6px 10px;
    border-radius: 4px;
    min-width: 180px;
    margin-left: auto;
  }

  #log-search:focus {
    outline: none;
    border-color: var(--color-accent);
  }

  #log-search::placeholder {
    color: var(--color-text-secondary);
  }

  .log-output {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    line-height: 1.5;
    overflow-y: auto;
    max-height: calc(100vh - 200px);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    padding: var(--spacing-xs);
  }

  .log-empty,
  .log-loading {
    text-align: center;
    color: var(--color-text-secondary);
    padding: var(--spacing-xl) 0;
    font-size: var(--font-size-sm);
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }
</style>

<style is:global>
  .tail-dot-active {
    background: #00e676 !important;
    animation: pulse 1.5s ease-in-out infinite;
  }

  [data-theme="light"] .tail-dot-active {
    background: #2e7d32 !important;
  }

  .tail-dot-paused {
    background: #ffab40 !important;
    animation: none !important;
  }

  [data-theme="light"] .tail-dot-paused {
    background: #ef6c00 !important;
  }

  .tail-dot-idle {
    background: var(--color-text-secondary) !important;
    animation: none !important;
  }

  .log-entry {
    padding: 4px 8px;
    border-bottom: 1px solid var(--color-border);
    white-space: pre-wrap;
    word-break: break-all;
  }

  .log-entry:last-child {
    border-bottom: none;
  }

  .log-level-error {
    color: var(--color-error);
  }

  .log-level-warn,
  .log-level-warning {
    color: var(--color-warning);
  }

  .log-level-info {
    color: var(--color-text);
  }

  .log-level-debug {
    color: var(--color-text-secondary);
  }

  .log-entry-ts {
    color: var(--color-text-secondary);
    font-size: 0.75rem;
  }

  .log-entry-tag {
    color: var(--color-accent);
  }

  .log-entry-message {
    /* Inherits color from level class on parent .log-entry */
  }

  .log-entry-json {
    color: var(--color-text-secondary);
    font-size: 0.75rem;
    margin: 2px 0 0 0;
    padding: 0;
    white-space: pre-wrap;
    word-break: break-all;
  }
</style>
